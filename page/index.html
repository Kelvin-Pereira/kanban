<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Kamban do Kelvin</title>
    <link rel="stylesheet" href="../assets/kanban.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Lato"
      rel="stylesheet"
    />

  </head>
  <body>

  <!-- jQuery library -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

  <!-- Popper -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

  <!-- Latest compiled and minified Bootstrap JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Initialize Bootstrap functionality -->
<script>
  // Initialize tooltip component
  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })

  // Initialize popover component
  $(function () {
    $('[data-toggle="popover"]').popover()
  })
</script>

    <div class="container">
      <div id="Kanban"></div>
    </div>
    
    <script src="../assets/kanban.js"></script>
    <script>
      var KanbanGLPI = new jKanban({
        element: "#Kanban",
        gutter: "5px",
        widthBoard: "280px",
        itemHandleOptions:{
        enabled: true,
        },
        click: function(el) {
          console.log("Disparar em todos os itens clicados!");
        },
        dropEl: function(el, target, source, sibling){
          console.log(target.parentElement.getAttribute('data-id'));

          //console.log(target) //target para onde foi
          //console.log(source) //onde estava
          
          // seta os novos valores
          size()

        },
        buttonClick: function(el, boardId) {
          console.log(boardId);
        },
        addItemButton: true,
        boards: [
          {
            id: "Atribuido",
            title: "Atribuido",
            class: "azulclaro",
            item: [
              {
                id: "_test_delete",
                title: "tenta olhar no console",
                numChamado: 45612,
                descricao: "descrição",
                prioridade: 'Média',
                // drag: function(el, source) {
                //   console.log("START DRAG: " + el.dataset.eid);
                // },
                // dragend: function(el) {
                //   console.log("END DRAG: " + el.dataset.eid);
                // },
                // drop: function(el) {
                //   console.log("DROPPED: " + el.dataset.eid);
                // }
              },
              {
                title: "Click Kelvin!",
                numChamado: 45123,
                descricao: "descrição",
                prioridade: 'Média',
                click: function(el) {
                  alert("Porq ?");
                },
                class: ["peppe", "bello"]
              },
              {
                title: "correr?",
                numChamado: 45412,
                descricao: "descrição",
                prioridade: 'Média',
              },
              {
                title: "Tudo Certo",
                numChamado: 45437,
                descricao: "descrição",
                prioridade: 'Média',
              },
              {
                title: "ela etsá gravida!",
                numChamado: 95613,
                descricao: "descrição",
                prioridade: 'Alta',
              },
              {
                title: "ela etsá gravida!",
                numChamado: 95631,
                descricao: "descrição",
                prioridade: 'Alta',
              }
            ]
          },
          {
            id: "Planejado",
            title: "Planejado",
            class: "azul",
            item: [
              {
                title: "Não mexa!",
                numChamado: 45814,
                descricao: "descrição",
                prioridade: 'Critical',
              }
            ]
          },
          {
            id: "Pendende",
            title: "Pendende",
            class: "amarelo",
            item: [
            
            ]
          },
          {
            id: "Solucionado",
            title: "Solucionado",
            class: "verde",
            item: [
            {
                title: "não faça!",
                numChamado: 54912,
                descricao: "descrição",
                prioridade: 'Muito alta',
              },
              {
                title: "quer mesmo correr?",
                numChamado: 55013,
                descricao: "descrição",
                prioridade: 'Baixa',
              },
              {
                title: "Click Kelvin!",
                numChamado: 55511,
                descricao: "descrição",
                prioridade: 'Muito baixa',
                click: function(el) {
                  alert("Porq ?");
                },
                class: ["peppe", "bello"]
              }
            ]
          }
        ]
      });

       // seta a quantidade de cards na torre
       function size() {
        document.getElementById("Atribuido").innerHTML    = this.KanbanGLPI.boardContainer[0].childNodes.length;
        document.getElementById("Planejado").innerHTML    = this.KanbanGLPI.boardContainer[1].childNodes.length;
        document.getElementById("Pendende").innerHTML     = this.KanbanGLPI.boardContainer[2].childNodes.length;
        document.getElementById("Solucionado").innerHTML  = this.KanbanGLPI.boardContainer[3].childNodes.length;
      }

    </script>

  </body>
</html>
